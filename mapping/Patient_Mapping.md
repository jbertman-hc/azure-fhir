# FHIR US Core Patient Mapping from DemographicsDomain

This document outlines the proposed mapping from the `DemographicsDomain` object (defined in `swagger.json`) to the FHIR R4 US Core Patient Profile (v6.1.0).

**Source:** `DemographicsDomain` schema in `swagger.json` (lines ~29226-29548)
**Target:** FHIR R4 `Patient` resource conforming to US Core v6.1.0 (`http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient`)

**Mapping Table:**

| DemographicsDomain Field (Swagger) | Data Type | FHIR US Core Patient Element  | Data Type        | Mapping Notes / Flags (US Core Specific)                                                                                                                                                              |
| :--------------------------------- | :-------- | :---------------------------- | :--------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `patientID`                        | integer   | `Patient.id`                  | `id`             | Use as FHIR resource logical ID? Needs strategy (e.g., prefix?). (No specific US Core requirement on format).                                                                                       |
| `chartID`                          | string    | `Patient.identifier` (**M**)  | `Identifier[]`   | **US Core:** Map as MRN. **FLAG:** Define appropriate `system` URL for the MRN identifier type specific to this source system. Set `use` = `usual`. (US Core *requires* at least one identifier). |
| `ss`                               | string    | `Patient.identifier`          | `Identifier[]`   | Map as SSN if necessary. `system` = `http://hl7.org/fhir/sid/us-ssn`. (US Core discourages sending SSN unless required).                                                                            |
| `patientGUID`                      | uuid      | `Patient.identifier`          | `Identifier[]`   | Map as another identifier? **FLAG:** Define `system` URL. `use` = `official`?                                                                                                                   |
| `acPmAccountId`                    | string    | `Patient.identifier`          | `Identifier[]`   | Map as another identifier? **FLAG:** Define `system` URL & context.                                                                                                                             |
| `salutation`                       | string    | `Patient.name.prefix`         | `string[]`       | Direct map.                                                                                                                                                                                       |
| `first`                            | string    | `Patient.name.given` (**M**)  | `string[]`       | Direct map (as first entry). (US Core *requires* at least one given name).                                                                                                                        |
| `middle` / `middleName`            | string    | `Patient.name.given`          | `string[]`       | Map as subsequent entry. **FLAG:** Confirm source/usage of `middle` vs `middleName`.                                                                                                               |
| `last`                             | string    | `Patient.name.family` (**M**) | `string`         | Direct map. (US Core *requires* family name).                                                                                                                                                     |
| `suffix`                           | string    | `Patient.name.suffix`         | `string[]`       | Direct map.                                                                                                                                                                                       |
| `mothersMaidenName`                | string    | Extension                     | `Extension`      | **FLAG:** Use standard Patient Mother's Maiden Name extension (`http://hl7.org/fhir/StructureDefinition/patient-mothersMaidenName`) if applicable.                                                  |
| `mothersFirstName`                 | string    | `Patient.contact`?            | `Patient.Contact`| **FLAG:** Potentially map to `Patient.contact` if mother represented. Needs context/rules.                                                                                                          |
| `birthDate`                        | date-time | `Patient.birthDate` (**M**)   | `date`           | **FLAG:** Truncate time. Validate format. (US Core *requires* birthDate).                                                                                                                            |
| `dateOfDeath`                      | date-time | `Patient.deceasedDateTime`    | `dateTime`       | Direct map if present.                                                                                                                                                                            |
| `birthOrder`                       | integer   | `Patient.multipleBirthInteger`| `integer`        | Direct map if > 0. **FLAG:** Clarify meaning if 0 or 1.                                                                                                                                         |
| `gender`                           | string    | `Patient.gender` (**M**)      | `code`           | **FLAG:** Needs mapping from source to required FHIR AdministrativeGender codes (`male`, `female`, `other`, `unknown`). (US Core *requires* gender).                                               |
| _N/A_                              | N/A       | `Patient.extension` (BirthSex)| `Extension[]`    | **FLAG:** US Core *requires* the Birth Sex extension (`http://hl7.org/fhir/us/core/StructureDefinition/us-core-birthsex`). **Need to identify source field or logic** for this.                 |
| `maritalStatus`                    | string    | `Patient.maritalStatus`       | `CodeableConcept`| **FLAG:** Needs mapping from source to FHIR Marital Status value set concepts. (Optional in US Core).                                                                                             |
| `patientRace`                      | string    | `Patient.extension` (Race) (**M**) | `Extension[]`    | **FLAG:** US Core *requires* the Race extension (`http://hl7.org/fhir/us/core/StructureDefinition/us-core-race`). **Needs mapping** from source string/code to OMB Race categories structure/codes. |
| `ethnicityID`                      | integer   | `Patient.extension` (Ethnicity) (**M**) | `Extension[]` | **FLAG:** US Core *requires* the Ethnicity extension (`http://hl7.org/fhir/us/core/StructureDefinition/us-core-ethnicity`). **Needs mapping** from source ID/code to OMB Ethnicity codes.      |
| `languagePreference`               | string    | `Patient.communication.language`| `CodeableConcept`| **FLAG:** Needs mapping from source to BCP-47 codes. `Patient.communication` is required by US Core *if* data exists.                                                                                |
| `barriersToCommunication`          | string    | Extension?                    | `Extension`      | **FLAG:** Unclear structure/meaning. Map to extension if defined.                                                                                                                                 |
| `contactPreference`                | string    | Extension?                    | `Extension`      | **FLAG:** Unclear structure/meaning. Map to extension.                                                                                                                                            |
| `publicityCode`                    | string    | Extension?                    | `Extension`      | **FLAG:** Unclear structure/meaning. Map to consent/privacy extension?                                                                                                                            |
| `publicityCodeEffectiveDate`       | date-time | Extension?                    | `Extension`      | Related to `publicityCode`. Map to extension.                                                                                                                                                     |
| `patientAddress`                   | string    | `Patient.address.line` (**M**) | `string[]`       | Map as first address line. (US Core requires `line`).                                                                                                                                              |
| `patientAddress2`                  | string    | `Patient.address.line`        | `string[]`       | Map as subsequent address line.                                                                                                                                                                   |
| `city`                             | string    | `Patient.address.city` (**M**) | `string`         | Direct map. (US Core requires `city`).                                                                                                                                                             |
| `state`                            | string    | `Patient.address.state` (**M**)| `string`         | Direct map. (US Core requires `state`).                                                                                                                                                            |
| `zip`                              | string    | `Patient.address.postalCode` (**M**) | `string`   | Direct map. (US Core requires `postalCode`).                                                                                                                                                       |
| _N/A_                              | N/A       | `Patient.address.country` (**M**) | `string`       | **FLAG:** Add `country` = 'US' (fixed value required by US Core if not otherwise specified).                                                                                                       |
| `phone`                            | string    | `Patient.telecom` (**M**)     | `ContactPoint[]` | Map as phone. `system`='phone', `use`='home'? (US Core requires telecom *if known*).                                                                                                               |
| `workPhone`                        | string    | `Patient.telecom`             | `ContactPoint[]` | Map as phone. `system`='phone', `use`='work'?                                                                                                                                                     |
| `fax`                              | string    | `Patient.telecom`             | `ContactPoint[]` | Map as fax. `system`='fax'.                                                                                                                                                                       |
| `email`                            | string    | `Patient.telecom`             | `ContactPoint[]` | Map as email. `system`='email'.                                                                                                                                                                   |
| `employerName`                     | string    | Extension?                    | `Extension`      | **FLAG:** Map to Occupation extension? Link to Organization?                                                                                                                                    |
| `emergencyContactName`             | string    | `Patient.contact.name`        | `HumanName`      | Map name parts (**FLAG:** parsing logic). Set relationship.                                                                                                                                       |
| `emergencyContactPhone`            | string    | `Patient.contact.telecom`     | `ContactPoint[]` | Map as phone. `system`='phone'.                                                                                                                                                                   |
| `spouseName`                       | string    | `Patient.contact.name`        | `HumanName`      | Map name parts (**FLAG:** parsing logic). Set relationship = 'SPS'.                                                                                                                               |
| `preferredPhysician`               | string    | `Patient.generalPractitioner` | `Reference[]`    | **FLAG:** Map string name to `Practitioner` Reference.                                                                                                                                            |
| `preferredPharmacy`                | string    | Extension?                    | `Extension`      | **FLAG:** Map to extension. Needs lookup to `Organization`?                                                                                                                                     |
| `inactive`                         | boolean   | `Patient.active`              | `boolean`        | Map as `!inactive`.                                                                                                                                                                               |
| `reasonInactive`                   | string    | Extension?                    | `Extension`      | **FLAG:** Map to extension.                                                                                                                                                                       |
| `dateTimePatientInactivated`       | date-time | Extension?                    | `Extension`      | **FLAG:** Map to extension.                                                                                                                                                                       |
| `picture`                          | byte      | `Patient.photo`               | `Attachment[]`   | Map base64. **FLAG:** Needs content type.                                                                                                                                                         |
| `imageName`                        | string    | `Patient.photo.title`?        | `string`         | Potential map.                                                                                                                                                                                    |
| **Insurance Fields**               | various   | **`Coverage` Resource**       | N/A              | **FLAG:** Belongs in US Core `Coverage` profile. **Do not map to `Patient`**.                                                                                                                       |
| **Other Fields** (Referral, Misc, Boolean Flags, VFC, Audit) | various | Extensions / Other Resources| Ext/Ref          | **FLAG:** Evaluate case-by-case for mapping to extensions or other resources (`AuditEvent`, `Immunization`, etc.).                                                                           |

**Key US Core Flags Requiring Action:**

1.  **Birth Sex:** Identify source data for the mandatory US Core Birth Sex extension.
2.  **Race Mapping:** Define mapping from `patientRace` to OMB codes for the mandatory US Core Race extension.
3.  **Ethnicity Mapping:** Define mapping from `ethnicityID` to OMB codes for the mandatory US Core Ethnicity extension.
4.  **MRN System:** Define the `system` URI for the `chartID` (MRN) identifier.
5.  **Gender Mapping:** Define mapping from `gender` string to FHIR `AdministrativeGender` codes.
6.  **Terminology Mappings:** Define mappings for `maritalStatus`, `languagePreference`.
7.  **Identifier Strategy:** Finalize strategy for `patientID`, `patientGUID`, `acPmAccountId`.
8.  **Extension Strategy:** Determine approach for fields like `mothersMaidenName`, `employerName`, `preferredPharmacy`, `reasonInactive`, etc.
9.  **Reference Resolution:** Implement logic to resolve `preferredPhysician` string to a `Practitioner` reference.
10. **Parsing Logic:** Implement logic to parse `emergencyContactName`, `spouseName` into `HumanName` components.

This documentation serves as a guide for implementing the complete and compliant mapping.
